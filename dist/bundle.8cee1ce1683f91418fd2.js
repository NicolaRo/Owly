(()=>{"use strict";var e,t={222:(e,t,o)=>{var i=o(83);const r=o.p+"assets/book-cover-placeholder.jpg",n="MISSING_ENV_VAR".API_BASE_URL;function a(e){return e&&"null"!==e&&"undefined"!==e?`https://covers.openlibrary.org/b/id/${e}-M.jpg`:r}function l(){const e=document.querySelector(".results-container");e&&e.remove()}let s=null;function c(e,t=!0){s&&d();const o=document.createElement("div");o.className="modal",o.innerHTML=`\n    <div class="modal-content"\n      role="alertdialog"\n      aria-modal="true"\n      aria-labelledby="dialog_label"\n      aria-describedby="dialog_desc">\n      <h2 id="dialog_label">${t?"Errore":"Messaggio"}</h2>\n      <p id="dialog_desc" style="color: ${t?"#d32f2f":"#388e3c"}">\n      ${e}\n      <button class="modal-close" id="modal-close">OK</button>\n    </div>\n  `,document.body.appendChild(o),s=o,o.querySelector(".modal-close").addEventListener("click",d)}function d(){s&&(s.remove(),s=null)}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("search-button"),t=document.getElementById("search-input"),o=document.getElementById("select-input"),r=e.innerHTML,s=e.getAttribute("aria-label")||"Cerca libri";async function d(){const d=t.value.trim(),u=o.value;if(d&&u){e.disabled=!0,e.innerHTML='<span class="spinner" aria-hidden="true"></span> Ricerca in corso...',e.setAttribute("aria-busy","true"),e.setAttribute("aria-label","Ricerca in corso, attendere"),l();try{const e=await function(e,t){const o=`${n}/search.json?${t}=${encodeURIComponent(e)}`;if(console.log("URL richiesta:",o),t)return i.A.get(o).then(e=>{const t=e.data.docs;return console.log("tutti i risultati",t),t});alert("Seleziona il tipo di ricerca.")}(d,u);!function(e){console.log("Dom.js riceve questi libri:",e),l();const t=document.createElement("div");t.className="results-container";const o=sessionStorage.getItem("viewMode")||"list-view";t.classList.add(o),document.querySelector(".hero-section").insertAdjacentElement("afterend",t);const r=document.createElement("div");r.className="toggle-placeholder";const s=document.createElement("button");s.className="toggle-button",s.textContent="Cambia vista",s.setAttribute("aria-label","Cambia visualizzazione lista/griglia"),r.appendChild(s),t.appendChild(r);const c=document.createElement("div");if(c.className="books-wrapper",t.appendChild(c),s.addEventListener("click",()=>{t.classList.contains("list-view")?(t.classList.remove("list-view"),t.classList.add("grid-view"),sessionStorage.setItem("viewMode","grid-view")):(t.classList.remove("grid-view"),t.classList.add("list-view"),sessionStorage.setItem("viewMode","list-view"))}),!e||0===e.length){const e=document.createElement("p");return e.setAttribute("role","status"),e.textContent="Nessun risultato trovato",e.className="no-results",e.setAttribute("aria-live","polite"),e.setAttribute("aria-label","Nessun risultato trovato"),void t.appendChild(e)}e.forEach(e=>{console.log("Book details:",e);const t=a(e.cover_i),o=document.createElement("div");o.className="book-result",o.style.setProperty("--book-cover-url",`url(${t})`);const i=Array.isArray(e.author_name)?e.author_name:[],r=i.slice(0,2).join(", "),n=i.length>2;o.innerHTML=`\n        <h3>${e.title||"Titolo non disponibile"}</h3>\n        <div class="book-content">\n          <div class="book-left">\n            <img src="${t}" alt="Copertina del libro" class="book-cover">\n            <button \n              class="book-details" \n              value="${e.key}"\n              data-title="${e.title?e.title.replace(/"/g,"&quot;"):"Titolo non disponibile"}"\n              data-bookYear="${e.first_publish_year}"\n              data-cover="${e.cover_i}" \n              data-author="${Array.isArray(e.author_name)?e.author_name.join(", "):"Autore non disponibile"}">\n              Dettagli Libro\n            </button>\n          </div>\n          <div class="book-right">\n            <p><strong>Autore:</strong> \n              ${0===i.length?"Autore non disponibile":r}\n              ${n?'<button class="show-more-authors" type="button">...</button>':""}<strong>Anno:</strong> ${e.first_publish_year||"Anno non disponibile"}</p>\n          </div>\n        </div>\n      `,c.appendChild(o),n&&o.querySelector(".show-more-authors").addEventListener("click",()=>{o.querySelector(".book-details")?.click()})}),document.querySelectorAll(".book-details").forEach(e=>{const o=e.getAttribute("data-title")||"Titolo non disponibile";e.setAttribute("aria-label",`Ottieni i dettagli del libro ${o}`),e.addEventListener("click",()=>{const o=document.querySelector(".book-description");o&&o.remove();const r=e.value,l=a(e.getAttribute("data-cover")),s=document.createElement("div");s.className="book-description",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.setAttribute("aria-labelledby","bookTitle");const c=document.createElement("button");c.className="close-button",c.textContent="Chiudi",c.setAttribute("aria-label","Chiudi dettagli libro"),c.addEventListener("click",()=>{s.remove()}),t.appendChild(s),function(e){console.log("Verifica bookKey",e);const t=`${n}${e}.json`;return console.log("URL dettagli libro:",t),i.A.get(t).then(e=>{console.log("Dettagli libro ottenuti:",e.data);const t=e.data;return!t.author_name&&t.authors&&(t.author_name=["Autore"]),t.description&&"object"==typeof t.description&&t.description.value&&(t.description=t.description.value),t})}(r).then(t=>{s.innerHTML=`\n                  <h4 id="bookTitle">${t.title||"Titolo non disponibile"}</h4>\n                  <img src="${l}" alt="Copertina del libro" class="book-cover">\n                  <p><strong>Autore:</strong> ${e.getAttribute("data-author")||"Autori non disponibili"}</p> \n                  <p><strong>Anno:</strong> ${e.getAttribute("data-bookYear")||"Anno non disponibile"}</p>\n                  <p><strong>Descrizione:</strong> ${t.description||"Nessuna descrizione disponibile."}</p>\n                `}).catch(e=>{console.error("Errore nel recupero dei dettagli del libro:",e),s.innerHTML="<p>Errore nel caricamento dei dettagli del libro.</p>"}).finally(()=>{s.appendChild(c)})})})}(e)}catch(e){console.error("Search error:",e),c("Errore durante la ricerca. Riprova piÃ¹ tardi.")}finally{e.disabled=!1,e.innerHTML=r,e.removeAttribute("aria-busy"),e.setAttribute("aria-label",s)}}else c(d?"Seleziona il tipo di ricerca":"Inserisci un termine di ricerca")}t.getAttribute("aria-label")||t.setAttribute("aria-label","Barra di ricerca libri"),o.getAttribute("aria-label")||o.setAttribute("aria-label","Filtra per tipo di ricerca"),e.getAttribute("aria-label")||e.setAttribute("aria-label",s),e.addEventListener("click",d),t.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),d())}),t.addEventListener("input",function(e,t=500){let o;return function(...i){clearTimeout(o),o=setTimeout(()=>e.apply(this,i),t)}}(()=>{console.log("Query aggiornata:",t.value.trim())},500))})}},o={};function i(e){var r=o[e];if(void 0!==r)return r.exports;var n=o[e]={exports:{}};return t[e](n,n.exports,i),n.exports}i.m=t,e=[],i.O=(t,o,r,n)=>{if(!o){var a=1/0;for(d=0;d<e.length;d++){for(var[o,r,n]=e[d],l=!0,s=0;s<o.length;s++)(!1&n||a>=n)&&Object.keys(i.O).every(e=>i.O[e](o[s]))?o.splice(s--,1):(l=!1,n<a&&(a=n));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,r,n]},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={792:0};i.O.j=t=>0===e[t];var t=(t,o)=>{var r,n,[a,l,s]=o,c=0;if(a.some(t=>0!==e[t])){for(r in l)i.o(l,r)&&(i.m[r]=l[r]);if(s)var d=s(i)}for(t&&t(o);c<a.length;c++)n=a[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},o=self.webpackChunkowly=self.webpackChunkowly||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=i.O(void 0,[83],()=>i(222));r=i.O(r)})();